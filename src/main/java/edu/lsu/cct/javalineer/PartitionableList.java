package edu.lsu.cct.javalineer;

import edu.lsu.cct.javalineer.functionalinterfaces.*;

import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.CompletableFuture;
import java.util.function.Function;

@SuppressWarnings({"unused", "CodeBlock2Expr"})
public class PartitionableList<E> {
    private final List<E> data;
    private final GuardVar<Boolean> busy;
    private final CondContext<CondTask1<Boolean>> notBusy;

    public PartitionableList(List<E> data) {
        this.data = data;
        this.busy = new GuardVar<>(false);
        this.notBusy = Guard.newCondition(this.busy);
    }

    public PartitionableList() {
        this(new ArrayList<>());
    }

    public static int partIndex(int part, int numParts, int size, int nGhosts) {
        int writableSize = size - 2*nGhosts;
        int n = writableSize / numParts;
        int r = writableSize % numParts;
        return n * part + Math.min(part, r) + nGhosts;
    }

    public ReadOnlyPartIntent<E> read() {
        return new ReadOnlyPartIntent<>(this);
    }

    public WriteOnlyPartIntent<E> write() {
        return new WriteOnlyPartIntent<>(this);
    }

    public ReadWritePartIntent<E> readWrite() {
        return new ReadWritePartIntent<>(this);
    }

    // region Generated by mkparts.py

    public static <T1> CompletableFuture<Void> runPartitioned(int nChunks,
                                                              ReadOnlyPartIntent<T1> pi1,
                                                              PartTask1<
                                                                      ReadOnlyPartListView<T1>,
                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, chunkTask);
    }

    public static <T1> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                              ReadOnlyPartIntent<T1> pi1,
                                                              PartTask1<
                                                                      ReadOnlyPartListView<T1>,
                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return chunkTask.apply(lv1);
        });
    }

    public static <T1> CompletableFuture<Void> runPartitioned(int nChunks,
                                                              WriteOnlyPartIntent<T1> pi1,
                                                              PartTask1<
                                                                      WriteOnlyPartListView<T1>,
                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, chunkTask);
    }

    public static <T1> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                              WriteOnlyPartIntent<T1> pi1,
                                                              PartTask1<
                                                                      WriteOnlyPartListView<T1>,
                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return chunkTask.apply(lv1);
        });
    }

    public static <T1, T2> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                  ReadOnlyPartIntent<T1> pi1,
                                                                  ReadOnlyPartIntent<T2> pi2,
                                                                  PartTask2<
                                                                          ReadOnlyPartListView<T1>,
                                                                          ReadOnlyPartListView<T2>,
                                                                          CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, chunkTask);
    }

    public static <T1, T2> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                  ReadOnlyPartIntent<T1> pi1,
                                                                  ReadOnlyPartIntent<T2> pi2,
                                                                  PartTask2<
                                                                          ReadOnlyPartListView<T1>,
                                                                          ReadOnlyPartListView<T2>,
                                                                          CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return chunkTask.apply(lv1, lv2);
            });
        });
    }

    public static <T1, T2> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                  WriteOnlyPartIntent<T1> pi1,
                                                                  ReadOnlyPartIntent<T2> pi2,
                                                                  PartTask2<
                                                                          WriteOnlyPartListView<T1>,
                                                                          ReadOnlyPartListView<T2>,
                                                                          CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, chunkTask);
    }

    public static <T1, T2> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                  WriteOnlyPartIntent<T1> pi1,
                                                                  ReadOnlyPartIntent<T2> pi2,
                                                                  PartTask2<
                                                                          WriteOnlyPartListView<T1>,
                                                                          ReadOnlyPartListView<T2>,
                                                                          CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return chunkTask.apply(lv1, lv2);
            });
        });
    }

    public static <T1, T2> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                  ReadOnlyPartIntent<T1> pi1,
                                                                  WriteOnlyPartIntent<T2> pi2,
                                                                  PartTask2<
                                                                          ReadOnlyPartListView<T1>,
                                                                          WriteOnlyPartListView<T2>,
                                                                          CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, chunkTask);
    }

    public static <T1, T2> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                  ReadOnlyPartIntent<T1> pi1,
                                                                  WriteOnlyPartIntent<T2> pi2,
                                                                  PartTask2<
                                                                          ReadOnlyPartListView<T1>,
                                                                          WriteOnlyPartListView<T2>,
                                                                          CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return chunkTask.apply(lv1, lv2);
            });
        });
    }

    public static <T1, T2> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                  WriteOnlyPartIntent<T1> pi1,
                                                                  WriteOnlyPartIntent<T2> pi2,
                                                                  PartTask2<
                                                                          WriteOnlyPartListView<T1>,
                                                                          WriteOnlyPartListView<T2>,
                                                                          CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, chunkTask);
    }

    public static <T1, T2> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                  WriteOnlyPartIntent<T1> pi1,
                                                                  WriteOnlyPartIntent<T2> pi2,
                                                                  PartTask2<
                                                                          WriteOnlyPartListView<T1>,
                                                                          WriteOnlyPartListView<T2>,
                                                                          CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return chunkTask.apply(lv1, lv2);
            });
        });
    }

    public static <T1, T2, T3> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                      ReadOnlyPartIntent<T1> pi1,
                                                                      ReadOnlyPartIntent<T2> pi2,
                                                                      ReadOnlyPartIntent<T3> pi3,
                                                                      PartTask3<
                                                                              ReadOnlyPartListView<T1>,
                                                                              ReadOnlyPartListView<T2>,
                                                                              ReadOnlyPartListView<T3>,
                                                                              CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, chunkTask);
    }

    public static <T1, T2, T3> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                      ReadOnlyPartIntent<T1> pi1,
                                                                      ReadOnlyPartIntent<T2> pi2,
                                                                      ReadOnlyPartIntent<T3> pi3,
                                                                      PartTask3<
                                                                              ReadOnlyPartListView<T1>,
                                                                              ReadOnlyPartListView<T2>,
                                                                              ReadOnlyPartListView<T3>,
                                                                              CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return chunkTask.apply(lv1, lv2, lv3);
                });
            });
        });
    }

    public static <T1, T2, T3> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                      WriteOnlyPartIntent<T1> pi1,
                                                                      ReadOnlyPartIntent<T2> pi2,
                                                                      ReadOnlyPartIntent<T3> pi3,
                                                                      PartTask3<
                                                                              WriteOnlyPartListView<T1>,
                                                                              ReadOnlyPartListView<T2>,
                                                                              ReadOnlyPartListView<T3>,
                                                                              CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, chunkTask);
    }

    public static <T1, T2, T3> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                      WriteOnlyPartIntent<T1> pi1,
                                                                      ReadOnlyPartIntent<T2> pi2,
                                                                      ReadOnlyPartIntent<T3> pi3,
                                                                      PartTask3<
                                                                              WriteOnlyPartListView<T1>,
                                                                              ReadOnlyPartListView<T2>,
                                                                              ReadOnlyPartListView<T3>,
                                                                              CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return chunkTask.apply(lv1, lv2, lv3);
                });
            });
        });
    }

    public static <T1, T2, T3> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                      ReadOnlyPartIntent<T1> pi1,
                                                                      WriteOnlyPartIntent<T2> pi2,
                                                                      ReadOnlyPartIntent<T3> pi3,
                                                                      PartTask3<
                                                                              ReadOnlyPartListView<T1>,
                                                                              WriteOnlyPartListView<T2>,
                                                                              ReadOnlyPartListView<T3>,
                                                                              CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, chunkTask);
    }

    public static <T1, T2, T3> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                      ReadOnlyPartIntent<T1> pi1,
                                                                      WriteOnlyPartIntent<T2> pi2,
                                                                      ReadOnlyPartIntent<T3> pi3,
                                                                      PartTask3<
                                                                              ReadOnlyPartListView<T1>,
                                                                              WriteOnlyPartListView<T2>,
                                                                              ReadOnlyPartListView<T3>,
                                                                              CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return chunkTask.apply(lv1, lv2, lv3);
                });
            });
        });
    }

    public static <T1, T2, T3> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                      WriteOnlyPartIntent<T1> pi1,
                                                                      WriteOnlyPartIntent<T2> pi2,
                                                                      ReadOnlyPartIntent<T3> pi3,
                                                                      PartTask3<
                                                                              WriteOnlyPartListView<T1>,
                                                                              WriteOnlyPartListView<T2>,
                                                                              ReadOnlyPartListView<T3>,
                                                                              CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, chunkTask);
    }

    public static <T1, T2, T3> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                      WriteOnlyPartIntent<T1> pi1,
                                                                      WriteOnlyPartIntent<T2> pi2,
                                                                      ReadOnlyPartIntent<T3> pi3,
                                                                      PartTask3<
                                                                              WriteOnlyPartListView<T1>,
                                                                              WriteOnlyPartListView<T2>,
                                                                              ReadOnlyPartListView<T3>,
                                                                              CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return chunkTask.apply(lv1, lv2, lv3);
                });
            });
        });
    }

    public static <T1, T2, T3> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                      ReadOnlyPartIntent<T1> pi1,
                                                                      ReadOnlyPartIntent<T2> pi2,
                                                                      WriteOnlyPartIntent<T3> pi3,
                                                                      PartTask3<
                                                                              ReadOnlyPartListView<T1>,
                                                                              ReadOnlyPartListView<T2>,
                                                                              WriteOnlyPartListView<T3>,
                                                                              CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, chunkTask);
    }

    public static <T1, T2, T3> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                      ReadOnlyPartIntent<T1> pi1,
                                                                      ReadOnlyPartIntent<T2> pi2,
                                                                      WriteOnlyPartIntent<T3> pi3,
                                                                      PartTask3<
                                                                              ReadOnlyPartListView<T1>,
                                                                              ReadOnlyPartListView<T2>,
                                                                              WriteOnlyPartListView<T3>,
                                                                              CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return chunkTask.apply(lv1, lv2, lv3);
                });
            });
        });
    }

    public static <T1, T2, T3> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                      WriteOnlyPartIntent<T1> pi1,
                                                                      ReadOnlyPartIntent<T2> pi2,
                                                                      WriteOnlyPartIntent<T3> pi3,
                                                                      PartTask3<
                                                                              WriteOnlyPartListView<T1>,
                                                                              ReadOnlyPartListView<T2>,
                                                                              WriteOnlyPartListView<T3>,
                                                                              CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, chunkTask);
    }

    public static <T1, T2, T3> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                      WriteOnlyPartIntent<T1> pi1,
                                                                      ReadOnlyPartIntent<T2> pi2,
                                                                      WriteOnlyPartIntent<T3> pi3,
                                                                      PartTask3<
                                                                              WriteOnlyPartListView<T1>,
                                                                              ReadOnlyPartListView<T2>,
                                                                              WriteOnlyPartListView<T3>,
                                                                              CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return chunkTask.apply(lv1, lv2, lv3);
                });
            });
        });
    }

    public static <T1, T2, T3> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                      ReadOnlyPartIntent<T1> pi1,
                                                                      WriteOnlyPartIntent<T2> pi2,
                                                                      WriteOnlyPartIntent<T3> pi3,
                                                                      PartTask3<
                                                                              ReadOnlyPartListView<T1>,
                                                                              WriteOnlyPartListView<T2>,
                                                                              WriteOnlyPartListView<T3>,
                                                                              CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, chunkTask);
    }

    public static <T1, T2, T3> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                      ReadOnlyPartIntent<T1> pi1,
                                                                      WriteOnlyPartIntent<T2> pi2,
                                                                      WriteOnlyPartIntent<T3> pi3,
                                                                      PartTask3<
                                                                              ReadOnlyPartListView<T1>,
                                                                              WriteOnlyPartListView<T2>,
                                                                              WriteOnlyPartListView<T3>,
                                                                              CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return chunkTask.apply(lv1, lv2, lv3);
                });
            });
        });
    }

    public static <T1, T2, T3> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                      WriteOnlyPartIntent<T1> pi1,
                                                                      WriteOnlyPartIntent<T2> pi2,
                                                                      WriteOnlyPartIntent<T3> pi3,
                                                                      PartTask3<
                                                                              WriteOnlyPartListView<T1>,
                                                                              WriteOnlyPartListView<T2>,
                                                                              WriteOnlyPartListView<T3>,
                                                                              CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, chunkTask);
    }

    public static <T1, T2, T3> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                      WriteOnlyPartIntent<T1> pi1,
                                                                      WriteOnlyPartIntent<T2> pi2,
                                                                      WriteOnlyPartIntent<T3> pi3,
                                                                      PartTask3<
                                                                              WriteOnlyPartListView<T1>,
                                                                              WriteOnlyPartListView<T2>,
                                                                              WriteOnlyPartListView<T3>,
                                                                              CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return chunkTask.apply(lv1, lv2, lv3);
                });
            });
        });
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                          ReadOnlyPartIntent<T1> pi1,
                                                                          ReadOnlyPartIntent<T2> pi2,
                                                                          ReadOnlyPartIntent<T3> pi3,
                                                                          ReadOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  ReadOnlyPartListView<T1>,
                                                                                  ReadOnlyPartListView<T2>,
                                                                                  ReadOnlyPartListView<T3>,
                                                                                  ReadOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, chunkTask);
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                          ReadOnlyPartIntent<T1> pi1,
                                                                          ReadOnlyPartIntent<T2> pi2,
                                                                          ReadOnlyPartIntent<T3> pi3,
                                                                          ReadOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  ReadOnlyPartListView<T1>,
                                                                                  ReadOnlyPartListView<T2>,
                                                                                  ReadOnlyPartListView<T3>,
                                                                                  ReadOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return chunkTask.apply(lv1, lv2, lv3, lv4);
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                          WriteOnlyPartIntent<T1> pi1,
                                                                          ReadOnlyPartIntent<T2> pi2,
                                                                          ReadOnlyPartIntent<T3> pi3,
                                                                          ReadOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  WriteOnlyPartListView<T1>,
                                                                                  ReadOnlyPartListView<T2>,
                                                                                  ReadOnlyPartListView<T3>,
                                                                                  ReadOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, chunkTask);
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                          WriteOnlyPartIntent<T1> pi1,
                                                                          ReadOnlyPartIntent<T2> pi2,
                                                                          ReadOnlyPartIntent<T3> pi3,
                                                                          ReadOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  WriteOnlyPartListView<T1>,
                                                                                  ReadOnlyPartListView<T2>,
                                                                                  ReadOnlyPartListView<T3>,
                                                                                  ReadOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return chunkTask.apply(lv1, lv2, lv3, lv4);
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                          ReadOnlyPartIntent<T1> pi1,
                                                                          WriteOnlyPartIntent<T2> pi2,
                                                                          ReadOnlyPartIntent<T3> pi3,
                                                                          ReadOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  ReadOnlyPartListView<T1>,
                                                                                  WriteOnlyPartListView<T2>,
                                                                                  ReadOnlyPartListView<T3>,
                                                                                  ReadOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, chunkTask);
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                          ReadOnlyPartIntent<T1> pi1,
                                                                          WriteOnlyPartIntent<T2> pi2,
                                                                          ReadOnlyPartIntent<T3> pi3,
                                                                          ReadOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  ReadOnlyPartListView<T1>,
                                                                                  WriteOnlyPartListView<T2>,
                                                                                  ReadOnlyPartListView<T3>,
                                                                                  ReadOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return chunkTask.apply(lv1, lv2, lv3, lv4);
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                          WriteOnlyPartIntent<T1> pi1,
                                                                          WriteOnlyPartIntent<T2> pi2,
                                                                          ReadOnlyPartIntent<T3> pi3,
                                                                          ReadOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  WriteOnlyPartListView<T1>,
                                                                                  WriteOnlyPartListView<T2>,
                                                                                  ReadOnlyPartListView<T3>,
                                                                                  ReadOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, chunkTask);
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                          WriteOnlyPartIntent<T1> pi1,
                                                                          WriteOnlyPartIntent<T2> pi2,
                                                                          ReadOnlyPartIntent<T3> pi3,
                                                                          ReadOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  WriteOnlyPartListView<T1>,
                                                                                  WriteOnlyPartListView<T2>,
                                                                                  ReadOnlyPartListView<T3>,
                                                                                  ReadOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return chunkTask.apply(lv1, lv2, lv3, lv4);
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                          ReadOnlyPartIntent<T1> pi1,
                                                                          ReadOnlyPartIntent<T2> pi2,
                                                                          WriteOnlyPartIntent<T3> pi3,
                                                                          ReadOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  ReadOnlyPartListView<T1>,
                                                                                  ReadOnlyPartListView<T2>,
                                                                                  WriteOnlyPartListView<T3>,
                                                                                  ReadOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, chunkTask);
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                          ReadOnlyPartIntent<T1> pi1,
                                                                          ReadOnlyPartIntent<T2> pi2,
                                                                          WriteOnlyPartIntent<T3> pi3,
                                                                          ReadOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  ReadOnlyPartListView<T1>,
                                                                                  ReadOnlyPartListView<T2>,
                                                                                  WriteOnlyPartListView<T3>,
                                                                                  ReadOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return chunkTask.apply(lv1, lv2, lv3, lv4);
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                          WriteOnlyPartIntent<T1> pi1,
                                                                          ReadOnlyPartIntent<T2> pi2,
                                                                          WriteOnlyPartIntent<T3> pi3,
                                                                          ReadOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  WriteOnlyPartListView<T1>,
                                                                                  ReadOnlyPartListView<T2>,
                                                                                  WriteOnlyPartListView<T3>,
                                                                                  ReadOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, chunkTask);
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                          WriteOnlyPartIntent<T1> pi1,
                                                                          ReadOnlyPartIntent<T2> pi2,
                                                                          WriteOnlyPartIntent<T3> pi3,
                                                                          ReadOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  WriteOnlyPartListView<T1>,
                                                                                  ReadOnlyPartListView<T2>,
                                                                                  WriteOnlyPartListView<T3>,
                                                                                  ReadOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return chunkTask.apply(lv1, lv2, lv3, lv4);
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                          ReadOnlyPartIntent<T1> pi1,
                                                                          WriteOnlyPartIntent<T2> pi2,
                                                                          WriteOnlyPartIntent<T3> pi3,
                                                                          ReadOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  ReadOnlyPartListView<T1>,
                                                                                  WriteOnlyPartListView<T2>,
                                                                                  WriteOnlyPartListView<T3>,
                                                                                  ReadOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, chunkTask);
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                          ReadOnlyPartIntent<T1> pi1,
                                                                          WriteOnlyPartIntent<T2> pi2,
                                                                          WriteOnlyPartIntent<T3> pi3,
                                                                          ReadOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  ReadOnlyPartListView<T1>,
                                                                                  WriteOnlyPartListView<T2>,
                                                                                  WriteOnlyPartListView<T3>,
                                                                                  ReadOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return chunkTask.apply(lv1, lv2, lv3, lv4);
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                          WriteOnlyPartIntent<T1> pi1,
                                                                          WriteOnlyPartIntent<T2> pi2,
                                                                          WriteOnlyPartIntent<T3> pi3,
                                                                          ReadOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  WriteOnlyPartListView<T1>,
                                                                                  WriteOnlyPartListView<T2>,
                                                                                  WriteOnlyPartListView<T3>,
                                                                                  ReadOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, chunkTask);
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                          WriteOnlyPartIntent<T1> pi1,
                                                                          WriteOnlyPartIntent<T2> pi2,
                                                                          WriteOnlyPartIntent<T3> pi3,
                                                                          ReadOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  WriteOnlyPartListView<T1>,
                                                                                  WriteOnlyPartListView<T2>,
                                                                                  WriteOnlyPartListView<T3>,
                                                                                  ReadOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return chunkTask.apply(lv1, lv2, lv3, lv4);
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                          ReadOnlyPartIntent<T1> pi1,
                                                                          ReadOnlyPartIntent<T2> pi2,
                                                                          ReadOnlyPartIntent<T3> pi3,
                                                                          WriteOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  ReadOnlyPartListView<T1>,
                                                                                  ReadOnlyPartListView<T2>,
                                                                                  ReadOnlyPartListView<T3>,
                                                                                  WriteOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, chunkTask);
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                          ReadOnlyPartIntent<T1> pi1,
                                                                          ReadOnlyPartIntent<T2> pi2,
                                                                          ReadOnlyPartIntent<T3> pi3,
                                                                          WriteOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  ReadOnlyPartListView<T1>,
                                                                                  ReadOnlyPartListView<T2>,
                                                                                  ReadOnlyPartListView<T3>,
                                                                                  WriteOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return chunkTask.apply(lv1, lv2, lv3, lv4);
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                          WriteOnlyPartIntent<T1> pi1,
                                                                          ReadOnlyPartIntent<T2> pi2,
                                                                          ReadOnlyPartIntent<T3> pi3,
                                                                          WriteOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  WriteOnlyPartListView<T1>,
                                                                                  ReadOnlyPartListView<T2>,
                                                                                  ReadOnlyPartListView<T3>,
                                                                                  WriteOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, chunkTask);
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                          WriteOnlyPartIntent<T1> pi1,
                                                                          ReadOnlyPartIntent<T2> pi2,
                                                                          ReadOnlyPartIntent<T3> pi3,
                                                                          WriteOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  WriteOnlyPartListView<T1>,
                                                                                  ReadOnlyPartListView<T2>,
                                                                                  ReadOnlyPartListView<T3>,
                                                                                  WriteOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return chunkTask.apply(lv1, lv2, lv3, lv4);
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                          ReadOnlyPartIntent<T1> pi1,
                                                                          WriteOnlyPartIntent<T2> pi2,
                                                                          ReadOnlyPartIntent<T3> pi3,
                                                                          WriteOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  ReadOnlyPartListView<T1>,
                                                                                  WriteOnlyPartListView<T2>,
                                                                                  ReadOnlyPartListView<T3>,
                                                                                  WriteOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, chunkTask);
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                          ReadOnlyPartIntent<T1> pi1,
                                                                          WriteOnlyPartIntent<T2> pi2,
                                                                          ReadOnlyPartIntent<T3> pi3,
                                                                          WriteOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  ReadOnlyPartListView<T1>,
                                                                                  WriteOnlyPartListView<T2>,
                                                                                  ReadOnlyPartListView<T3>,
                                                                                  WriteOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return chunkTask.apply(lv1, lv2, lv3, lv4);
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                          WriteOnlyPartIntent<T1> pi1,
                                                                          WriteOnlyPartIntent<T2> pi2,
                                                                          ReadOnlyPartIntent<T3> pi3,
                                                                          WriteOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  WriteOnlyPartListView<T1>,
                                                                                  WriteOnlyPartListView<T2>,
                                                                                  ReadOnlyPartListView<T3>,
                                                                                  WriteOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, chunkTask);
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                          WriteOnlyPartIntent<T1> pi1,
                                                                          WriteOnlyPartIntent<T2> pi2,
                                                                          ReadOnlyPartIntent<T3> pi3,
                                                                          WriteOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  WriteOnlyPartListView<T1>,
                                                                                  WriteOnlyPartListView<T2>,
                                                                                  ReadOnlyPartListView<T3>,
                                                                                  WriteOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return chunkTask.apply(lv1, lv2, lv3, lv4);
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                          ReadOnlyPartIntent<T1> pi1,
                                                                          ReadOnlyPartIntent<T2> pi2,
                                                                          WriteOnlyPartIntent<T3> pi3,
                                                                          WriteOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  ReadOnlyPartListView<T1>,
                                                                                  ReadOnlyPartListView<T2>,
                                                                                  WriteOnlyPartListView<T3>,
                                                                                  WriteOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, chunkTask);
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                          ReadOnlyPartIntent<T1> pi1,
                                                                          ReadOnlyPartIntent<T2> pi2,
                                                                          WriteOnlyPartIntent<T3> pi3,
                                                                          WriteOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  ReadOnlyPartListView<T1>,
                                                                                  ReadOnlyPartListView<T2>,
                                                                                  WriteOnlyPartListView<T3>,
                                                                                  WriteOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return chunkTask.apply(lv1, lv2, lv3, lv4);
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                          WriteOnlyPartIntent<T1> pi1,
                                                                          ReadOnlyPartIntent<T2> pi2,
                                                                          WriteOnlyPartIntent<T3> pi3,
                                                                          WriteOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  WriteOnlyPartListView<T1>,
                                                                                  ReadOnlyPartListView<T2>,
                                                                                  WriteOnlyPartListView<T3>,
                                                                                  WriteOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, chunkTask);
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                          WriteOnlyPartIntent<T1> pi1,
                                                                          ReadOnlyPartIntent<T2> pi2,
                                                                          WriteOnlyPartIntent<T3> pi3,
                                                                          WriteOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  WriteOnlyPartListView<T1>,
                                                                                  ReadOnlyPartListView<T2>,
                                                                                  WriteOnlyPartListView<T3>,
                                                                                  WriteOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return chunkTask.apply(lv1, lv2, lv3, lv4);
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                          ReadOnlyPartIntent<T1> pi1,
                                                                          WriteOnlyPartIntent<T2> pi2,
                                                                          WriteOnlyPartIntent<T3> pi3,
                                                                          WriteOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  ReadOnlyPartListView<T1>,
                                                                                  WriteOnlyPartListView<T2>,
                                                                                  WriteOnlyPartListView<T3>,
                                                                                  WriteOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, chunkTask);
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                          ReadOnlyPartIntent<T1> pi1,
                                                                          WriteOnlyPartIntent<T2> pi2,
                                                                          WriteOnlyPartIntent<T3> pi3,
                                                                          WriteOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  ReadOnlyPartListView<T1>,
                                                                                  WriteOnlyPartListView<T2>,
                                                                                  WriteOnlyPartListView<T3>,
                                                                                  WriteOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return chunkTask.apply(lv1, lv2, lv3, lv4);
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                          WriteOnlyPartIntent<T1> pi1,
                                                                          WriteOnlyPartIntent<T2> pi2,
                                                                          WriteOnlyPartIntent<T3> pi3,
                                                                          WriteOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  WriteOnlyPartListView<T1>,
                                                                                  WriteOnlyPartListView<T2>,
                                                                                  WriteOnlyPartListView<T3>,
                                                                                  WriteOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, chunkTask);
    }

    public static <T1, T2, T3, T4> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                          WriteOnlyPartIntent<T1> pi1,
                                                                          WriteOnlyPartIntent<T2> pi2,
                                                                          WriteOnlyPartIntent<T3> pi3,
                                                                          WriteOnlyPartIntent<T4> pi4,
                                                                          PartTask4<
                                                                                  WriteOnlyPartListView<T1>,
                                                                                  WriteOnlyPartListView<T2>,
                                                                                  WriteOnlyPartListView<T3>,
                                                                                  WriteOnlyPartListView<T4>,
                                                                                  CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return chunkTask.apply(lv1, lv2, lv3, lv4);
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              ReadOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      ReadOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              ReadOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      ReadOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              ReadOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      ReadOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              ReadOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      ReadOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              ReadOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      ReadOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedReadOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return runPartitioned(nChunks, 0, pi1, pi2, pi3, pi4, pi5, chunkTask);
    }

    public static <T1, T2, T3, T4, T5> CompletableFuture<Void> runPartitioned(int nChunks, int nGhosts,
                                                                              WriteOnlyPartIntent<T1> pi1,
                                                                              WriteOnlyPartIntent<T2> pi2,
                                                                              WriteOnlyPartIntent<T3> pi3,
                                                                              WriteOnlyPartIntent<T4> pi4,
                                                                              WriteOnlyPartIntent<T5> pi5,
                                                                              PartTask5<
                                                                                      WriteOnlyPartListView<T1>,
                                                                                      WriteOnlyPartListView<T2>,
                                                                                      WriteOnlyPartListView<T3>,
                                                                                      WriteOnlyPartListView<T4>,
                                                                                      WriteOnlyPartListView<T5>,
                                                                                      CompletableFuture<Void>> chunkTask) {
        return pi1.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv1 -> {
            return pi2.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv2 -> {
                return pi3.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv3 -> {
                    return pi4.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv4 -> {
                        return pi5.getUnderlying().runPartitionedWriteOnly(nChunks, nGhosts, lv5 -> {
                            return chunkTask.apply(lv1, lv2, lv3, lv4, lv5);
                        });
                    });
                });
            });
        });
    }
// endregion

    public CompletableFuture<Void> runPartitionedReadWrite(int nChunks,
                                                           int nGhosts,
                                                           PartTask1<ReadWritePartListView<E>, CompletableFuture<Void>> chunkTask) {
        var done = new CompletableFuture<Void>();

        Guard.runCondition(notBusy, busyVar -> {
            if (busyVar.get()) {
                return false;
            }

            busyVar.set(true);

            final var dataSize = data.size();

            final var tasksDone = new CountdownLatch(nChunks);

            for (int i = 0; i < nChunks-1; i++) {
                final var lo = partIndex(i, nChunks, dataSize, nGhosts);
                final var hi = partIndex(i+1, nChunks, dataSize, nGhosts);
                final var chunkSize = hi - lo;
                Pool.run(() -> {
                    final var view = new ReadWritePartListView<>(data, lo, chunkSize, nGhosts);
                    chunkTask.apply(view).thenRun(tasksDone::signal);
                });
            }
            final var lo = partIndex(nChunks-1, nChunks, dataSize, nGhosts);
            final var hi = partIndex(nChunks, nChunks, dataSize, nGhosts);
            final var chunkSize = hi - lo;
            final var view = new ReadWritePartListView<>(data, lo, chunkSize, nGhosts);
            chunkTask.apply(view).thenRun(tasksDone::signal);

            tasksDone.getFut().thenRun(() -> {
                done.complete(null);
                Guard.runGuarded(busy, busyVar1 -> {
                    busyVar1.set(false);
                    notBusy.signal();
                });
            });

            return true;
        });

        return done;
    }

    public CompletableFuture<Void> runPartitionedReadOnly(int nChunks,
                                                          int nGhosts,
                                                          PartTask1<ReadOnlyPartListView<E>, CompletableFuture<Void>> chunkTask) {
        var done = new CompletableFuture<Void>();

        Guard.runCondition(notBusy, busyVar -> {
            if (busyVar.get()) {
                return false;
            }

            busyVar.set(true);

            final var dataSize = data.size();

            final var tasksDone = new CountdownLatch(nChunks);

            for (int i = 0; i < nChunks-1; i++) {
                final var lo = partIndex(i, nChunks, dataSize, nGhosts);
                final var hi = partIndex(i+1, nChunks, dataSize, nGhosts);
                final var chunkSize = hi - lo;
                Pool.run(() -> {
                    final var view = new ReadOnlyPartListView<>(data, lo, chunkSize, nGhosts);
                    chunkTask.apply(view).thenRun(tasksDone::signal);
                });
            }
            final var lo = partIndex(nChunks-1, nChunks, dataSize, nGhosts);
            final var hi = partIndex(nChunks, nChunks, dataSize, nGhosts);
            final var chunkSize = hi - lo;
            final var view = new ReadOnlyPartListView<>(data, lo, chunkSize, nGhosts);
            chunkTask.apply(view).thenRun(tasksDone::signal);

            tasksDone.getFut().thenRun(() -> {
                done.complete(null);
                Guard.runGuarded(busy, busyVar1 -> {
                    busyVar1.set(false);
                    notBusy.signal();
                });
            });

            return true;
        });

        return done;
    }

    public CompletableFuture<Void> runPartitionedWriteOnly(int nChunks,
                                                           int nGhosts,
                                                           PartTask1<WriteOnlyPartListView<E>, CompletableFuture<Void>> chunkTask) {
        var done = new CompletableFuture<Void>();

        Guard.runCondition(notBusy, busyVar -> {
            if (busyVar.get()) {
                return false;
            }

            busyVar.set(true);

            final var dataSize = data.size();

            final var tasksDone = new CountdownLatch(nChunks);

            for (int i = 0; i < nChunks-1; i++) {
                final var lo = partIndex(i, nChunks, dataSize, nGhosts);
                final var hi = partIndex(i+1, nChunks, dataSize, nGhosts);
                final var chunkSize = hi - lo;
                Pool.run(() -> {
                    final var view = new WriteOnlyPartListView<>(data, lo, chunkSize, nGhosts);
                    chunkTask.apply(view).thenRun(tasksDone::signal);
                });
            }
            final var lo = partIndex(nChunks-1, nChunks, dataSize, nGhosts);
            final var hi = partIndex(nChunks, nChunks, dataSize, nGhosts);
            final var chunkSize = hi - lo;
            final var view = new WriteOnlyPartListView<>(data, lo, chunkSize, nGhosts);
            chunkTask.apply(view).thenRun(tasksDone::signal);

            tasksDone.getFut().thenRun(() -> {
                done.complete(null);
                Guard.runGuarded(busy, busyVar1 -> {
                    busyVar1.set(false);
                    notBusy.signal();
                });
            });

            return true;
        });

        return done;
    }

    public CompletableFuture<E> reducePartitioned(int nChunks,
                                                  Function<ReadOnlyPartListView<E>, CompletableFuture<E>> chunkTask) {
        return reducePartitioned(nChunks, 0, chunkTask);
    }

    public CompletableFuture<E> reducePartitioned(int nChunks,
                                                  int nGhosts,
                                                  Function<ReadOnlyPartListView<E>, CompletableFuture<E>> chunkTask) {
        var result = new CompletableFuture<E>();

        Guard.runCondition(notBusy, busyVar -> {
            if (busyVar.get()) {
                return false;
            }

            busyVar.set(true);

            final var dataSize = data.size();

            final var tasksDone = new CountdownLatch(nChunks);

            final var intermediateList = new ArrayList<E>(nChunks);
            final var intermediateGuard = new Guard();

            for (int i = 0; i < nChunks - 1; i++) {
                final var lo = partIndex(i, nChunks, dataSize, nGhosts);
                final var hi = partIndex(i+1, nChunks, dataSize, nGhosts);
                final var chunkSize = hi - lo;
                Pool.run(() -> {
                    final var view = new ReadOnlyPartListView<>(data, lo, chunkSize, nGhosts);
                    chunkTask.apply(view).thenAccept(res -> {
                        Guard.runGuarded(intermediateGuard, () -> {
                            intermediateList.add(res);
                            tasksDone.signal();
                        });
                    });
                });
            }

            final var lo = partIndex(nChunks - 1, nChunks, dataSize, nGhosts);
            final var hi = partIndex(nChunks, nChunks, dataSize, nGhosts);
            final var chunkSize = hi - lo;
            final var viewLast = new ReadOnlyPartListView<>(data, lo, chunkSize, nGhosts);
            chunkTask.apply(viewLast).thenAccept(res -> {
                Guard.runGuarded(intermediateGuard, () -> {
                    intermediateList.add(res);
                    tasksDone.signal();
                });
            });

            tasksDone.getFut().thenRun(() -> {
                assert nChunks == intermediateList.size();
                final var view = new ReadOnlyPartListView<>(intermediateList, 0, nChunks, 0);

                chunkTask.apply(view).thenAccept(result::complete);

                Guard.runGuarded(busy, busyVar1 -> {
                    busyVar1.set(false);
                    notBusy.signal();
                });
            });

            return true;
        });

        return result;
    }
}
